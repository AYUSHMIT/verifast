#ifndef PRINCIPALS_GH
#define PRINCIPALS_GH

#include <crypto.gh>

require_module principals_mod;

predicate principals(int id);

lemma void principals_init();
  requires module(principals_mod, true);
  ensures  module(principals_mod, false) &*&
           principals(0);

lemma void principals_exit();
  requires principals(_);
  ensures  true;

fixpoint bool bad(int principal);

lemma int principal_create();
  requires principals(?count);
  ensures  principals(count + 1) &*& result == count + 1 &*&
           principal(count + 1, 0);

lemma void principal_destroy(int id);
  requires principal(id, _);
  ensures  true;

#endif
